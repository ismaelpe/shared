# Main groovy classes

The most important groovy classes are:

### PipelineData

This is the most important class. It allows you to execute all the groovy scripts, it contains all the pipeline info (repo, action, origin branch), and the result of several pipeline steps.

It has several methods to init the class, depending the type of pipeline that needs it.

.Most important attributes
|===
|Name|Description
|ancientMapInfo| It contains the previous artifact deployed in the environment
|resultDeployInfo| It contains the result of the deploy (An object for every data center)
|pipelineId|The unique pipeline Id, this id is used by GPL
|gitAction|The git action that has triggered the Continous Integration Pipeline
|gitUrl|The url of the repo
|commitLog|The commit associated with the git event
|originPushToMaster|If the event is a PUSH to the master branch, it may contain the origin branch of the Merge (It can be a feature or release)
|deployFlag|It indicates if the pipeline has to deploy the artifact to the cloud environment
|branchStructure|It indicates the origin branch associated with the git event
|pipelineStructure| It indicates the stages and the next actions (depending on the executed flow)
|garArtifactType| It indicates the gar app, associated with the project. The type of app gar
|pipelineStructureType| It indicates the type of pipeline... Continuos integration, Rollback, Create Release...
|bmxStructure| It contains all the info to deploy the artifact on the cloud environment
|buildCode| It contains the buildCode, it depends if on the artifact version (SNAPSHOT, RELEASE, RELEASE CANDIDATE)
|revapiStructure| Only a application pipeline contains this info
|===

.Most important methods
|===
|Name|Description
|init| This method is one of the several init methods that can init the pipeline data.
|initFromIOPPro| This method is called to initialize the data structure during a deploy-to-pro pipeline
|initFromRelease| This method is called to initialize the data structure durting a create-release pipeline
|initFromClose| This method is called to close a release when it has been deployed in PRO environment
|initFromRollback| This method is called to initialize the data structure during a rollback pipeline
|initFromReleaseCandidate| This method is called to init the data structure during a create-release-candidate pipeline
|initFromGitUrlGarApp| This method is called from the others inits methods. It can init the GarAppType using the git repo or the JenkinsFile
|===

### PomXmlStructure

This is the other most important class, it contains all the artifact info parsing the pom.xml

.Most important attributes
|===
|Name|Description
|applicationName|It contains the name of the application, can differs from the artifactName
|artifactName|The name of the artifact, is the artifactId value in the pom.xml
|artifactVersion|The version of the artifact, is the value in the pom.xml
|groupId|The group id of the artifact
|artifactType|It can be SIMPLE (only one artifact), or AGREGADOR (more than one artifac)
|artifactSubType|It can be the type of artifact, if the artifactType is SIMPLE this indicates the type of artifact (LIB,MICRO)
|artifactSampleApp| If the repo is an AGREGADOR this attribute contains the id of the sample app (only the plugins or starter can contais a sample app) (-sample-app)
|artifactLib| It contains the id of the lib (-lib suffix)
|artifactMicro| The id of the micro, (only the micro artifact type can contains a micro module) (-server/-micro suffix)
|archVersion| The id of the architecture version of the artifact
|===

.Most important methods
|===
|Name|Description
|initXmlStructure|This method initializes the attributes by means the pom information
|===

### DeployStructure

The deployStructure is the class that contains the information about the deploy, it is generated by the BmxStructure.

A deployStructure contains the data specific data of a specific environment, for example C1 of TST, or of PRO.

.Most important attributes
|===
|Name|Description
|url_int|the internal url of this infraestucture
|url_ext|the external url of this infraestucture
|environment|the Cloud Foundry environment (EDEN, DEV, TST, PRE, PRO)
|org|Cloud Foundry organization
|space|Cloud Foundry space 
|console_Admin|the url of the console to make login 
|idCenter|the internal identifier of the Cloud Founndry infraestucture Data Center 
|suffixedComponentName|the url pre/suffix to be used during the consolidantion phase. For exemple, a new artifact is deployed with the new-xxx before the pipelines make the integration test. BETA component are deployed using a -beta suffix after the component name.
|ancientVersion|the deploy task informs the previous state of the artifact. Is there an ancient?
|===

.Most important methods
|===
|Name|Description
|getEnvVariables|this method is used during the generation of the app manifest, it return all the information to bind the push with the environment variables, like the ABSIS_SPACE. This information could be used by the runtime to modify the behavior.
|=== 

### BmxStructure

This structure describes the cloud foundry environment. For example if the pipeline has to push an artifact against TST, this structure describes the TST environment.


.All known implementing classes
|===
|Name|Description
|EdenBmxStructure|It defines the eden infraestructure (TST)
|DevBmxStructure|It defines the dev infraestructure (TST)
|TstBmxStructure|It defines the tst infraestructure (TST)
|PreBmxStructure|It defines the PRE (PRE)
|ProBmxStructure|It defines PRO (PRO)
|===

### ResultPipelineData

This defines the next actions to execute depending on the result.
Every type of pipeline has an implementing classes of this abstract class.

.All known implementing classes
|===
|Name|Description
|FeatureResultPipelineData|The CI uses this class to indicate to gpl the next actions of a push in a feature branch
|MasterResultPipelineData|The CI uses this class to indicate to gpl the next actions of a push in the master branch
|IopProResultPipelineJobData|The iop-to-pro uses this class to indicate the next actions to gpl of the job iop to pro
|ReleaseCandidateResultPipelineJobData|The result of the job create release canidate
|ReleaseResultPipelineData|The CI uses this class to indicate to gpl the next actions of a push in the release branch
|ReleaseResultPipelineJobData|The create release uses this class to indicate the next actions to gpl of the job create release
|RollbackResultPipelineJobData|The rollback uses this class to indicate the next actions to gpl of a rollback action
|RollbackFinishResultPipelineJobData|The rollback_finish uses this class to indicate the next actions to gpl of a rollback action
|CloseResultPipelineJobData|The close uses this class to indicate the next actions to gpl of a close action
|===


.Most important methods
|===
|Name|Description
|getAcciones|this method allows to indicate the next actions for this result exeution and this type of pipeline
|getDeployed|this indicates if the pipeline has deployed an artifact on CloudFoundy environment
|=== 

### PipelineStructure

This class is used to indicate to gpl the steps of the actual job

.All known implementing classes
|===
|Name|Description
|CIPipelineStructure|All the jobs executed by the continous integration use this data structure
|CreateReleaseCandidatePipelineStructure|The create release candidate use this data structure
|CreateReleasePipelineStructure|The create release use this data structure
|IopProPipelineStructure|The iop to pro use this data
|RollbackPipelineStructure|The rollback job use this data
|ClosePipelineStructure| The close release use this data
|===

.Most important methods
|===
|Name|Description
|getStages|this method allows to indicate the stages used by this pipeline
|=== 
